<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><a name="line-7"></a><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><a name="line-8"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-pragma">{-# OPTIONS_HADDOCK prune #-}</span><span>
</span><a name="line-11"></a><span>
</span><a name="line-12"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.Address.Derivation</span><span>
</span><a name="line-13"></a><span>    </span><span class="hs-special">(</span><span>
</span><a name="line-14"></a><span>    </span><span class="hs-comment">-- * Overview</span><span>
</span><a name="line-15"></a><span>    </span><span class="hs-comment">-- $overview</span><span>
</span><a name="line-16"></a><span>
</span><a name="line-17"></a><span>    </span><span class="hs-comment">-- * Key Derivation</span><span>
</span><a name="line-18"></a><span>    </span><span class="hs-comment">-- ** Types</span><span>
</span><a name="line-19"></a><span>      </span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-type">Index</span></a><span>
</span><a name="line-20"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#indexToWord32"><span class="hs-identifier hs-var">indexToWord32</span></a><span>
</span><a name="line-21"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#indexFromWord32"><span class="hs-identifier hs-var">indexFromWord32</span></a><span>
</span><a name="line-22"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#wholeDomainIndex"><span class="hs-identifier hs-var">wholeDomainIndex</span></a><span>
</span><a name="line-23"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#coerceWholeDomainIndex"><span class="hs-identifier hs-var">coerceWholeDomainIndex</span></a><span>
</span><a name="line-24"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#nextIndex"><span class="hs-identifier hs-var">nextIndex</span></a><span>
</span><a name="line-25"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#Depth"><span class="hs-identifier hs-type">Depth</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-26"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#DerivationType"><span class="hs-identifier hs-type">DerivationType</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span>    </span><span class="hs-comment">-- * Abstractions</span><span>
</span><a name="line-29"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#GenMasterKey"><span class="hs-identifier hs-type">GenMasterKey</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#HardDerivation"><span class="hs-identifier hs-type">HardDerivation</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-31"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#SoftDerivation"><span class="hs-identifier hs-type">SoftDerivation</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span>    </span><span class="hs-comment">-- * Low-Level Cryptography Primitives</span><span>
</span><a name="line-34"></a><span>    </span><span class="hs-comment">-- ** XPrv</span><span>
</span><a name="line-35"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a><span>
</span><a name="line-36"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#xprvFromBytes"><span class="hs-identifier hs-var">xprvFromBytes</span></a><span>
</span><a name="line-37"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#xprvToBytes"><span class="hs-identifier hs-var">xprvToBytes</span></a><span>
</span><a name="line-38"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#xprvPrivateKey"><span class="hs-identifier hs-var">xprvPrivateKey</span></a><span>
</span><a name="line-39"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#xprvChainCode"><span class="hs-identifier hs-var">xprvChainCode</span></a><span>
</span><a name="line-40"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#toXPub"><span class="hs-identifier hs-var">toXPub</span></a><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span>    </span><span class="hs-comment">-- ** XPub</span><span>
</span><a name="line-43"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#XPub"><span class="hs-identifier hs-type">XPub</span></a><span>
</span><a name="line-44"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#xpubFromBytes"><span class="hs-identifier hs-var">xpubFromBytes</span></a><span>
</span><a name="line-45"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#xpubToBytes"><span class="hs-identifier hs-var">xpubToBytes</span></a><span>
</span><a name="line-46"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#xpubPublicKey"><span class="hs-identifier hs-var">xpubPublicKey</span></a><span>
</span><a name="line-47"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#xpubChainCode"><span class="hs-identifier hs-var">xpubChainCode</span></a><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span>    </span><span class="hs-comment">-- ** XSignature</span><span>
</span><a name="line-50"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#XSignature"><span class="hs-identifier hs-type">XSignature</span></a><span>
</span><a name="line-51"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#sign"><span class="hs-identifier hs-var">sign</span></a><span>
</span><a name="line-52"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#verify"><span class="hs-identifier hs-var">verify</span></a><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span>    </span><span class="hs-comment">-- Internal / Not exposed by Haddock</span><span>
</span><a name="line-55"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">DerivationScheme</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-56"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#deriveXPrv"><span class="hs-identifier hs-var">deriveXPrv</span></a><span>
</span><a name="line-57"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#deriveXPub"><span class="hs-identifier hs-var">deriveXPub</span></a><span>
</span><a name="line-58"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#generate"><span class="hs-identifier hs-var">generate</span></a><span>
</span><a name="line-59"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#generateNew"><span class="hs-identifier hs-var">generateNew</span></a><span>
</span><a name="line-60"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#hashCredential"><span class="hs-identifier hs-var">hashCredential</span></a><span>
</span><a name="line-61"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#credentialHashSize"><span class="hs-identifier hs-var">credentialHashSize</span></a><span>
</span><a name="line-62"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Cardano.Address.Derivation.html#unsafeMkIndex"><span class="hs-identifier hs-var">unsafeMkIndex</span></a><span>
</span><a name="line-63"></a><span>    </span><span class="hs-comment">------------------</span><span>
</span><a name="line-64"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Cardano.Crypto.Wallet</span><span>
</span><a name="line-69"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">DerivationScheme</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-70"></a><span class="hs-keyword">import</span><span> </span><a href="Cardano.Mnemonic.html"><span class="hs-identifier">Cardano.Mnemonic</span></a><span>
</span><a name="line-71"></a><span>    </span><span class="hs-special">(</span><span> </span><a href="Cardano.Mnemonic.html#SomeMnemonic"><span class="hs-identifier hs-type">SomeMnemonic</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-72"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.DeepSeq</span><span>
</span><a name="line-73"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Crypto.Error</span><span>
</span><a name="line-75"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">eitherCryptoError</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Crypto.Hash</span><span>
</span><a name="line-77"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">hash</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-78"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Crypto.Hash.Algorithms</span><span>
</span><a name="line-79"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Blake2b_224</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-80"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Crypto.Hash.IO</span><span>
</span><a name="line-81"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">HashAlgorithm</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">hashDigestSize</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-82"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.ByteArray</span><span>
</span><a name="line-83"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">ByteArrayAccess</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ScrubbedBytes</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-84"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.ByteString</span><span>
</span><a name="line-85"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-86"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Coerce</span><span>
</span><a name="line-87"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">coerce</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-88"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Either.Extra</span><span>
</span><a name="line-89"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">eitherToMaybe</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-90"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.String</span><span>
</span><a name="line-91"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">fromString</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-92"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Word</span><span>
</span><a name="line-93"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Word32</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-94"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Fmt</span><span>
</span><a name="line-95"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Buildable</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-96"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Generics</span><span>
</span><a name="line-97"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">Generic</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-98"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Stack</span><span>
</span><a name="line-99"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">HasCallStack</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Cardano.Crypto.Wallet</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">CC</span><span>
</span><a name="line-102"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Crypto.ECC.Edwards25519</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Ed25519</span><span>
</span><a name="line-103"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.ByteArray</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">BA</span><span>
</span><a name="line-104"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.ByteString</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">BS</span><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span class="hs-comment">-- $overview</span><span>
</span><a name="line-107"></a><span class="hs-comment">--</span><span>
</span><a name="line-108"></a><span class="hs-comment">-- These abstractions allow generating root private key, also called /Master Key/</span><span>
</span><a name="line-109"></a><span class="hs-comment">-- and then basing on it enable address derivation</span><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span class="hs-comment">--</span><span>
</span><a name="line-112"></a><span class="hs-comment">-- Low-Level Cryptography Primitives</span><span>
</span><a name="line-113"></a><span class="hs-comment">--</span><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span class="hs-comment">-- | An opaque type representing an extended private key.</span><span>
</span><a name="line-116"></a><span class="hs-comment">--</span><span>
</span><a name="line-117"></a><span class="hs-comment">-- __Properties:__</span><span>
</span><a name="line-118"></a><span class="hs-comment">--</span><span>
</span><a name="line-119"></a><span class="hs-comment">-- ===== Roundtripping</span><span>
</span><a name="line-120"></a><span class="hs-comment">--</span><span>
</span><a name="line-121"></a><span class="hs-comment">-- @forall xprv. 'xprvFromBytes' ('xprvToBytes' xprv) == 'Just' xprv@</span><span>
</span><a name="line-122"></a><span class="hs-comment">--</span><span>
</span><a name="line-123"></a><span class="hs-comment">-- ===== Chain Code Invariance</span><span>
</span><a name="line-124"></a><span class="hs-comment">--</span><span>
</span><a name="line-125"></a><span class="hs-comment">-- @forall xprv. 'xprvChainCode' xprv == 'xpubChainCode' ('toXPub' xprv)@</span><span>
</span><a name="line-126"></a><span class="hs-comment">--</span><span>
</span><a name="line-127"></a><span class="hs-comment">-- ===== Public Key Signature</span><span>
</span><a name="line-128"></a><span class="hs-comment">--</span><span>
</span><a name="line-129"></a><span class="hs-comment">-- @forall xprv msg. 'verify' ('toXPub' xprv) msg ('sign' xprv msg) == 'True'@</span><span>
</span><a name="line-130"></a><span class="hs-comment">--</span><span>
</span><a name="line-131"></a><span class="hs-comment">-- @since 1.0.0</span><span>
</span><a name="line-132"></a><span class="hs-keyword">type</span><span> </span><a name="XPrv"><a href="Cardano.Address.Derivation.html#XPrv"><span class="hs-identifier">XPrv</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">CC.XPrv</span><span>
</span><a name="line-133"></a><span>
</span><a name="line-134"></a><span class="hs-comment">-- | An opaque type representing an extended public key.</span><span>
</span><a name="line-135"></a><span class="hs-comment">--</span><span>
</span><a name="line-136"></a><span class="hs-comment">-- __Properties:__</span><span>
</span><a name="line-137"></a><span class="hs-comment">--</span><span>
</span><a name="line-138"></a><span class="hs-comment">-- ===== Roundtripping</span><span>
</span><a name="line-139"></a><span class="hs-comment">--</span><span>
</span><a name="line-140"></a><span class="hs-comment">-- @forall xpub. 'xpubFromBytes' ('xpubToBytes' xpub) == 'Just' xpub@</span><span>
</span><a name="line-141"></a><span class="hs-comment">--</span><span>
</span><a name="line-142"></a><span class="hs-comment">-- @since 1.0.0</span><span>
</span><a name="line-143"></a><span class="hs-keyword">type</span><span> </span><a name="XPub"><a href="Cardano.Address.Derivation.html#XPub"><span class="hs-identifier">XPub</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">CC.XPub</span><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span class="hs-comment">-- | An opaque type representing a signature made from an 'XPrv'.</span><span>
</span><a name="line-146"></a><span class="hs-comment">--</span><span>
</span><a name="line-147"></a><span class="hs-comment">-- @since 1.0.0</span><span>
</span><a name="line-148"></a><span class="hs-keyword">type</span><span> </span><a name="XSignature"><a href="Cardano.Address.Derivation.html#XSignature"><span class="hs-identifier">XSignature</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">CC.XSignature</span><span>
</span><a name="line-149"></a><span>
</span><a name="line-150"></a><span class="hs-comment">-- | Construct an 'XPub' from raw 'ByteString' (64 bytes).</span><span>
</span><a name="line-151"></a><span class="hs-comment">--</span><span>
</span><a name="line-152"></a><span class="hs-comment">-- @since 1.0.0</span><span>
</span><a name="line-153"></a><span class="hs-identifier">xpubFromBytes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Cardano.Address.Derivation.html#XPub"><span class="hs-identifier hs-type">XPub</span></a><span>
</span><a name="line-154"></a><a name="xpubFromBytes"><a href="Cardano.Address.Derivation.html#xpubFromBytes"><span class="hs-identifier">xpubFromBytes</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">eitherToMaybe</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">CC.xpub</span><span>
</span><a name="line-155"></a><span>
</span><a name="line-156"></a><span class="hs-comment">-- | Convert an 'XPub' to a raw 'ByteString' (64 bytes).</span><span>
</span><a name="line-157"></a><span class="hs-comment">--</span><span>
</span><a name="line-158"></a><span class="hs-comment">-- @since 1.0.0</span><span>
</span><a name="line-159"></a><span class="hs-identifier">xpubToBytes</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Address.Derivation.html#XPub"><span class="hs-identifier hs-type">XPub</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-160"></a><a name="xpubToBytes"><a href="Cardano.Address.Derivation.html#xpubToBytes"><span class="hs-identifier">xpubToBytes</span></a></a><span> </span><a name="local-6989586621679110728"><a href="#local-6989586621679110728"><span class="hs-identifier">xpub</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Cardano.Address.Derivation.html#xpubPublicKey"><span class="hs-identifier hs-var">xpubPublicKey</span></a><span> </span><a href="#local-6989586621679110728"><span class="hs-identifier hs-var">xpub</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Cardano.Address.Derivation.html#xpubChainCode"><span class="hs-identifier hs-var">xpubChainCode</span></a><span> </span><a href="#local-6989586621679110728"><span class="hs-identifier hs-var">xpub</span></a><span>
</span><a name="line-161"></a><span>
</span><a name="line-162"></a><span class="hs-comment">-- | Extract the public key from an 'XPub' as a raw 'ByteString' (32 bytes).</span><span>
</span><a name="line-163"></a><span class="hs-comment">--</span><span>
</span><a name="line-164"></a><span class="hs-comment">-- @since 2.0.0</span><span>
</span><a name="line-165"></a><span class="hs-identifier">xpubPublicKey</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Address.Derivation.html#XPub"><span class="hs-identifier hs-type">XPub</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-166"></a><a name="xpubPublicKey"><a href="Cardano.Address.Derivation.html#xpubPublicKey"><span class="hs-identifier">xpubPublicKey</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">CC.XPub</span><span> </span><a name="local-6989586621679110729"><a href="#local-6989586621679110729"><span class="hs-identifier">pub</span></a></a><span> </span><a name="local-6989586621679110730"><a href="#local-6989586621679110730"><span class="hs-identifier">_cc</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110729"><span class="hs-identifier hs-var">pub</span></a><span>
</span><a name="line-167"></a><span>
</span><a name="line-168"></a><span class="hs-comment">-- | Extract the chain code from an 'XPub' as a raw 'ByteString' (32 bytes).</span><span>
</span><a name="line-169"></a><span class="hs-comment">--</span><span>
</span><a name="line-170"></a><span class="hs-comment">-- @since 2.0.0</span><span>
</span><a name="line-171"></a><span class="hs-identifier">xpubChainCode</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Address.Derivation.html#XPub"><span class="hs-identifier hs-type">XPub</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-172"></a><a name="xpubChainCode"><a href="Cardano.Address.Derivation.html#xpubChainCode"><span class="hs-identifier">xpubChainCode</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">CC.XPub</span><span> </span><a name="local-6989586621679110731"><a href="#local-6989586621679110731"><span class="hs-identifier">_pub</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">CC.ChainCode</span><span> </span><a name="local-6989586621679110732"><a href="#local-6989586621679110732"><span class="hs-identifier">cc</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679110732"><span class="hs-identifier hs-var">cc</span></a><span>
</span><a name="line-173"></a><span>
</span><a name="line-174"></a><span class="hs-comment">-- | Construct an 'XPrv' from raw 'ByteString' (96 bytes).</span><span>
</span><a name="line-175"></a><span class="hs-comment">--</span><span>
</span><a name="line-176"></a><span class="hs-comment">-- @since 1.0.0</span><span>
</span><a name="line-177"></a><span class="hs-identifier">xprvFromBytes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Cardano.Address.Derivation.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a><span>
</span><a name="line-178"></a><a name="xprvFromBytes"><a href="Cardano.Address.Derivation.html#xprvFromBytes"><span class="hs-identifier">xprvFromBytes</span></a></a><span> </span><a name="local-6989586621679110733"><a href="#local-6989586621679110733"><span class="hs-identifier">bytes</span></a></a><span>
</span><a name="line-179"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">BS.length</span><span> </span><a href="#local-6989586621679110733"><span class="hs-identifier hs-var">bytes</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">96</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-180"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-181"></a><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679110737"><a href="#local-6989586621679110737"><span class="hs-identifier">prv</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679110738"><a href="#local-6989586621679110738"><span class="hs-identifier">cc</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">BS.splitAt</span><span> </span><span class="hs-number">64</span><span> </span><a href="#local-6989586621679110733"><span class="hs-identifier hs-var">bytes</span></a><span>
</span><a name="line-182"></a><span>        </span><a name="local-6989586621679110739"><a href="#local-6989586621679110739"><span class="hs-identifier">pub</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679110734"><span class="hs-identifier hs-var">ed25519ScalarMult</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">BS.take</span><span> </span><span class="hs-number">32</span><span> </span><a href="#local-6989586621679110737"><span class="hs-identifier hs-var">prv</span></a><span class="hs-special">)</span><span>
</span><a name="line-183"></a><span>        </span><span class="hs-identifier hs-var">eitherToMaybe</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">CC.xprv</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679110737"><span class="hs-identifier hs-var">prv</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679110739"><span class="hs-identifier hs-var">pub</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679110738"><span class="hs-identifier hs-var">cc</span></a><span>
</span><a name="line-184"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-185"></a><span>    </span><span class="hs-identifier">ed25519ScalarMult</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-186"></a><span>    </span><a name="local-6989586621679110734"><a href="#local-6989586621679110734"><span class="hs-identifier">ed25519ScalarMult</span></a></a><span> </span><a name="local-6989586621679110735"><a href="#local-6989586621679110735"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-187"></a><span>        </span><a name="local-6989586621679110736"><a href="#local-6989586621679110736"><span class="hs-identifier">scalar</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">eitherToMaybe</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">eitherCryptoError</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Ed25519.scalarDecodeLong</span><span> </span><a href="#local-6989586621679110735"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-188"></a><span>        </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Ed25519.pointEncode</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Ed25519.toPoint</span><span> </span><a href="#local-6989586621679110736"><span class="hs-identifier hs-var">scalar</span></a><span>
</span><a name="line-189"></a><span>
</span><a name="line-190"></a><span class="hs-comment">-- From  &lt; xprv | pub | cc &gt;</span><span>
</span><a name="line-191"></a><span class="hs-comment">-- &#8627; To  &lt; xprv |     | cc &gt;</span><span>
</span><a name="line-192"></a><span class="hs-comment">--</span><span>
</span><a name="line-193"></a><span class="hs-comment">-- | Convert an 'XPrv' to a raw 'ByteString' (96 bytes).</span><span>
</span><a name="line-194"></a><span class="hs-comment">--</span><span>
</span><a name="line-195"></a><span class="hs-comment">-- @since 1.0.0</span><span>
</span><a name="line-196"></a><span class="hs-identifier">xprvToBytes</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Address.Derivation.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-197"></a><a name="xprvToBytes"><a href="Cardano.Address.Derivation.html#xprvToBytes"><span class="hs-identifier">xprvToBytes</span></a></a><span> </span><a name="local-6989586621679110740"><a href="#local-6989586621679110740"><span class="hs-identifier">xprv</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-198"></a><span>    </span><a href="Cardano.Address.Derivation.html#xprvPrivateKey"><span class="hs-identifier hs-var">xprvPrivateKey</span></a><span> </span><a href="#local-6989586621679110740"><span class="hs-identifier hs-var">xprv</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="Cardano.Address.Derivation.html#xprvChainCode"><span class="hs-identifier hs-var">xprvChainCode</span></a><span> </span><a href="#local-6989586621679110740"><span class="hs-identifier hs-var">xprv</span></a><span>
</span><a name="line-199"></a><span>
</span><a name="line-200"></a><span class="hs-comment">-- | Extract the private key from an 'XPrv' as a raw 'ByteString' (64 bytes).</span><span>
</span><a name="line-201"></a><span class="hs-comment">--</span><span>
</span><a name="line-202"></a><span class="hs-comment">-- @since 2.0.0</span><span>
</span><a name="line-203"></a><span class="hs-identifier">xprvPrivateKey</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Address.Derivation.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-204"></a><a name="xprvPrivateKey"><a href="Cardano.Address.Derivation.html#xprvPrivateKey"><span class="hs-identifier">xprvPrivateKey</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">BS.take</span><span> </span><span class="hs-number">64</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">CC.unXPrv</span><span>
</span><a name="line-205"></a><span>
</span><a name="line-206"></a><span class="hs-comment">-- | Extract the chain code from an 'XPrv' as a raw 'ByteString' (32 bytes).</span><span>
</span><a name="line-207"></a><span class="hs-comment">--</span><span>
</span><a name="line-208"></a><span class="hs-comment">-- @since 2.0.0</span><span>
</span><a name="line-209"></a><span class="hs-identifier">xprvChainCode</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Address.Derivation.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-210"></a><a name="xprvChainCode"><a href="Cardano.Address.Derivation.html#xprvChainCode"><span class="hs-identifier">xprvChainCode</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">BS.drop</span><span> </span><span class="hs-number">96</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">CC.unXPrv</span><span>
</span><a name="line-211"></a><span>
</span><a name="line-212"></a><span class="hs-comment">-- | Derive the 'XPub' associated with an 'XPrv'.</span><span>
</span><a name="line-213"></a><span class="hs-comment">--</span><span>
</span><a name="line-214"></a><span class="hs-comment">-- @since 1.0.0</span><span>
</span><a name="line-215"></a><span class="hs-identifier">toXPub</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">HasCallStack</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Cardano.Address.Derivation.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Address.Derivation.html#XPub"><span class="hs-identifier hs-type">XPub</span></a><span>
</span><a name="line-216"></a><a name="toXPub"><a href="Cardano.Address.Derivation.html#toXPub"><span class="hs-identifier">toXPub</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">CC.toXPub</span><span>
</span><a name="line-217"></a><span>
</span><a name="line-218"></a><span class="hs-comment">-- | Produce a signature of the given 'msg' from an 'XPrv'.</span><span>
</span><a name="line-219"></a><span class="hs-comment">--</span><span>
</span><a name="line-220"></a><span class="hs-comment">-- @since 1.0.0</span><span>
</span><a name="line-221"></a><span class="hs-identifier">sign</span><span>
</span><a name="line-222"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ByteArrayAccess</span><span> </span><a href="#local-6989586621679110727"><span class="hs-identifier hs-type">msg</span></a><span>
</span><a name="line-223"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Cardano.Address.Derivation.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a><span>
</span><a name="line-224"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110727"><span class="hs-identifier hs-type">msg</span></a><span>
</span><a name="line-225"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Address.Derivation.html#XSignature"><span class="hs-identifier hs-type">XSignature</span></a><span>
</span><a name="line-226"></a><a name="sign"><a href="Cardano.Address.Derivation.html#sign"><span class="hs-identifier">sign</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-227"></a><span>    </span><span class="hs-identifier hs-var">CC.sign</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mempty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ScrubbedBytes</span><span class="hs-special">)</span><span>
</span><a name="line-228"></a><span>
</span><a name="line-229"></a><span class="hs-comment">-- | Verify the 'XSignature' of a 'msg' with the 'XPub' associated with the</span><span>
</span><a name="line-230"></a><span class="hs-comment">-- 'XPrv' used for signing.</span><span>
</span><a name="line-231"></a><span class="hs-comment">--</span><span>
</span><a name="line-232"></a><span class="hs-comment">-- @since 1.0.0</span><span>
</span><a name="line-233"></a><span class="hs-identifier">verify</span><span>
</span><a name="line-234"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ByteArrayAccess</span><span> </span><a href="#local-6989586621679110726"><span class="hs-identifier hs-type">msg</span></a><span>
</span><a name="line-235"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Cardano.Address.Derivation.html#XPub"><span class="hs-identifier hs-type">XPub</span></a><span>
</span><a name="line-236"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110726"><span class="hs-identifier hs-type">msg</span></a><span>
</span><a name="line-237"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Address.Derivation.html#XSignature"><span class="hs-identifier hs-type">XSignature</span></a><span>
</span><a name="line-238"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-239"></a><a name="verify"><a href="Cardano.Address.Derivation.html#verify"><span class="hs-identifier">verify</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-240"></a><span>    </span><span class="hs-identifier hs-var">CC.verify</span><span> </span><span class="hs-comment">-- re-exported for the sake of documentation.</span><span>
</span><a name="line-241"></a><span>
</span><a name="line-242"></a><span class="hs-comment">-- Derive a child extended private key from an extended private key</span><span>
</span><a name="line-243"></a><span class="hs-comment">--</span><span>
</span><a name="line-244"></a><span class="hs-comment">-- __internal__</span><span>
</span><a name="line-245"></a><span class="hs-identifier">deriveXPrv</span><span>
</span><a name="line-246"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DerivationScheme</span><span>
</span><a name="line-247"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Address.Derivation.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a><span>
</span><a name="line-248"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-type">Index</span></a><span> </span><a href="#local-6989586621679110724"><span class="hs-identifier hs-type">derivationType</span></a><span> </span><a href="#local-6989586621679110725"><span class="hs-identifier hs-type">depth</span></a><span>
</span><a name="line-249"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Address.Derivation.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a><span>
</span><a name="line-250"></a><a name="deriveXPrv"><a href="Cardano.Address.Derivation.html#deriveXPrv"><span class="hs-identifier">deriveXPrv</span></a></a><span> </span><a name="local-6989586621679110741"><a href="#local-6989586621679110741"><span class="hs-identifier">ds</span></a></a><span> </span><a name="local-6989586621679110742"><a href="#local-6989586621679110742"><span class="hs-identifier">prv</span></a></a><span> </span><span class="hs-special">(</span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-var">Index</span></a><span> </span><a name="local-6989586621679110743"><a href="#local-6989586621679110743"><span class="hs-identifier">ix</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-251"></a><span>    </span><span class="hs-identifier hs-var">CC.deriveXPrv</span><span> </span><a href="#local-6989586621679110741"><span class="hs-identifier hs-var">ds</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mempty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ScrubbedBytes</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679110742"><span class="hs-identifier hs-var">prv</span></a><span> </span><a href="#local-6989586621679110743"><span class="hs-identifier hs-var">ix</span></a><span>
</span><a name="line-252"></a><span>
</span><a name="line-253"></a><span class="hs-comment">-- Derive a child extended public key from an extended public key</span><span>
</span><a name="line-254"></a><span class="hs-comment">--</span><span>
</span><a name="line-255"></a><span class="hs-comment">-- __internal__</span><span>
</span><a name="line-256"></a><span class="hs-identifier">deriveXPub</span><span>
</span><a name="line-257"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">DerivationScheme</span><span>
</span><a name="line-258"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Address.Derivation.html#XPub"><span class="hs-identifier hs-type">XPub</span></a><span>
</span><a name="line-259"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-type">Index</span></a><span> </span><a href="#local-6989586621679110722"><span class="hs-identifier hs-type">derivationType</span></a><span> </span><a href="#local-6989586621679110723"><span class="hs-identifier hs-type">depth</span></a><span>
</span><a name="line-260"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Cardano.Address.Derivation.html#XPub"><span class="hs-identifier hs-type">XPub</span></a><span>
</span><a name="line-261"></a><a name="deriveXPub"><a href="Cardano.Address.Derivation.html#deriveXPub"><span class="hs-identifier">deriveXPub</span></a></a><span> </span><a name="local-6989586621679110744"><a href="#local-6989586621679110744"><span class="hs-identifier">ds</span></a></a><span> </span><a name="local-6989586621679110745"><a href="#local-6989586621679110745"><span class="hs-identifier">pub</span></a></a><span> </span><span class="hs-special">(</span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-var">Index</span></a><span> </span><a name="local-6989586621679110746"><a href="#local-6989586621679110746"><span class="hs-identifier">ix</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-262"></a><span>    </span><span class="hs-identifier hs-var">CC.deriveXPub</span><span> </span><a href="#local-6989586621679110744"><span class="hs-identifier hs-var">ds</span></a><span> </span><a href="#local-6989586621679110745"><span class="hs-identifier hs-var">pub</span></a><span> </span><a href="#local-6989586621679110746"><span class="hs-identifier hs-var">ix</span></a><span>
</span><a name="line-263"></a><span>
</span><a name="line-264"></a><span class="hs-comment">-- Generate an XPrv using the legacy method (Byron).</span><span>
</span><a name="line-265"></a><span class="hs-comment">--</span><span>
</span><a name="line-266"></a><span class="hs-comment">-- The seed needs to be at least 32 bytes, otherwise an asynchronous error is thrown.</span><span>
</span><a name="line-267"></a><span class="hs-comment">--</span><span>
</span><a name="line-268"></a><span class="hs-comment">-- __internal__</span><span>
</span><a name="line-269"></a><span class="hs-identifier">generate</span><span>
</span><a name="line-270"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ByteArrayAccess</span><span> </span><a href="#local-6989586621679110721"><span class="hs-identifier hs-type">seed</span></a><span>
</span><a name="line-271"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679110721"><span class="hs-identifier hs-type">seed</span></a><span>
</span><a name="line-272"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Address.Derivation.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a><span>
</span><a name="line-273"></a><a name="generate"><a href="Cardano.Address.Derivation.html#generate"><span class="hs-identifier">generate</span></a></a><span> </span><a name="local-6989586621679110747"><a href="#local-6989586621679110747"><span class="hs-identifier">seed</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-274"></a><span>    </span><span class="hs-identifier hs-var">CC.generate</span><span> </span><a href="#local-6989586621679110747"><span class="hs-identifier hs-var">seed</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mempty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ScrubbedBytes</span><span class="hs-special">)</span><span>
</span><a name="line-275"></a><span>
</span><a name="line-276"></a><span class="hs-comment">-- Generate an XPrv using the new method (Icarus).</span><span>
</span><a name="line-277"></a><span class="hs-comment">--</span><span>
</span><a name="line-278"></a><span class="hs-comment">-- The seed needs to be at least 16 bytes.</span><span>
</span><a name="line-279"></a><span class="hs-comment">--</span><span>
</span><a name="line-280"></a><span class="hs-comment">-- __internal__</span><span>
</span><a name="line-281"></a><span class="hs-identifier">generateNew</span><span>
</span><a name="line-282"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ByteArrayAccess</span><span> </span><a href="#local-6989586621679110719"><span class="hs-identifier hs-type">seed</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ByteArrayAccess</span><span> </span><a href="#local-6989586621679110720"><span class="hs-identifier hs-type">sndFactor</span></a><span class="hs-special">)</span><span>
</span><a name="line-283"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679110719"><span class="hs-identifier hs-type">seed</span></a><span>
</span><a name="line-284"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110720"><span class="hs-identifier hs-type">sndFactor</span></a><span>
</span><a name="line-285"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Address.Derivation.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a><span>
</span><a name="line-286"></a><a name="generateNew"><a href="Cardano.Address.Derivation.html#generateNew"><span class="hs-identifier">generateNew</span></a></a><span> </span><a name="local-6989586621679110748"><a href="#local-6989586621679110748"><span class="hs-identifier">seed</span></a></a><span> </span><a name="local-6989586621679110749"><a href="#local-6989586621679110749"><span class="hs-identifier">sndFactor</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-287"></a><span>    </span><span class="hs-identifier hs-var">CC.generateNew</span><span> </span><a href="#local-6989586621679110748"><span class="hs-identifier hs-var">seed</span></a><span> </span><a href="#local-6989586621679110749"><span class="hs-identifier hs-var">sndFactor</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mempty</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ScrubbedBytes</span><span class="hs-special">)</span><span>
</span><a name="line-288"></a><span>
</span><a name="line-289"></a><span class="hs-comment">-- Hash a credential (pub key or script).</span><span>
</span><a name="line-290"></a><span class="hs-comment">--</span><span>
</span><a name="line-291"></a><span class="hs-comment">-- __internal__</span><span>
</span><a name="line-292"></a><span class="hs-identifier">hashCredential</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ByteString</span><span>
</span><a name="line-293"></a><a name="hashCredential"><a href="Cardano.Address.Derivation.html#hashCredential"><span class="hs-identifier">hashCredential</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-294"></a><span>    </span><span class="hs-identifier hs-var">BA.convert</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">hash</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">@</span><span class="hs-identifier hs-type">Blake2b_224</span><span>
</span><a name="line-295"></a><span>
</span><a name="line-296"></a><span class="hs-comment">-- Size, in bytes, of a hash of credential (pub key or script).</span><span>
</span><a name="line-297"></a><span class="hs-comment">--</span><span>
</span><a name="line-298"></a><span class="hs-comment">-- __internal__</span><span>
</span><a name="line-299"></a><span class="hs-identifier">credentialHashSize</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-300"></a><a name="credentialHashSize"><a href="Cardano.Address.Derivation.html#credentialHashSize"><span class="hs-identifier">credentialHashSize</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">hashDigestSize</span><span> </span><span class="hs-identifier hs-var">Blake2b_224</span><span>
</span><a name="line-301"></a><span>
</span><a name="line-302"></a><span class="hs-comment">--</span><span>
</span><a name="line-303"></a><span class="hs-comment">-- Key Derivation</span><span>
</span><a name="line-304"></a><span class="hs-comment">--</span><span>
</span><a name="line-305"></a><span>
</span><a name="line-306"></a><span class="hs-comment">-- | Key Depth in the derivation path, according to BIP-0039 / BIP-0044</span><span>
</span><a name="line-307"></a><span class="hs-comment">--</span><span>
</span><a name="line-308"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-309"></a><span class="hs-comment">-- root | purpose' | cointype' | account' | role | address@</span><span>
</span><a name="line-310"></a><span class="hs-comment">-- 0th      1st         2nd        3rd       4th     5th</span><span>
</span><a name="line-311"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-312"></a><span class="hs-comment">--</span><span>
</span><a name="line-313"></a><span class="hs-comment">-- We do not manipulate purpose, cointype and change paths directly, so there</span><span>
</span><a name="line-314"></a><span class="hs-comment">-- are no constructors for these.</span><span>
</span><a name="line-315"></a><span class="hs-comment">--</span><span>
</span><a name="line-316"></a><span class="hs-comment">-- @since 1.0.0</span><span>
</span><a name="line-317"></a><span class="hs-keyword">data</span><span> </span><a name="Depth"><a href="Cardano.Address.Derivation.html#Depth"><span class="hs-identifier">Depth</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="RootK"><a href="Cardano.Address.Derivation.html#RootK"><span class="hs-identifier">RootK</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="AccountK"><a href="Cardano.Address.Derivation.html#AccountK"><span class="hs-identifier">AccountK</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="PaymentK"><a href="Cardano.Address.Derivation.html#PaymentK"><span class="hs-identifier">PaymentK</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="DelegationK"><a href="Cardano.Address.Derivation.html#DelegationK"><span class="hs-identifier">DelegationK</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="ScriptK"><a href="Cardano.Address.Derivation.html#ScriptK"><span class="hs-identifier">ScriptK</span></a></a><span>
</span><a name="line-318"></a><span>
</span><a name="line-319"></a><span class="hs-comment">-- | A derivation index, with phantom-types to disambiguate derivation type.</span><span>
</span><a name="line-320"></a><span class="hs-comment">--</span><span>
</span><a name="line-321"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-322"></a><span class="hs-comment">-- let accountIx = Index 'Hardened 'AccountK</span><span>
</span><a name="line-323"></a><span class="hs-comment">-- let addressIx = Index 'Soft 'PaymentK</span><span>
</span><a name="line-324"></a><span class="hs-comment">-- @</span><span>
</span><a name="line-325"></a><span class="hs-comment">--</span><span>
</span><a name="line-326"></a><span class="hs-comment">-- @since 1.0.0</span><span>
</span><a name="line-327"></a><span class="hs-keyword">newtype</span><span> </span><a name="Index"><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier">Index</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679110695"><a href="#local-6989586621679110695"><span class="hs-identifier">derivationType</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Address.Derivation.html#DerivationType"><span class="hs-identifier hs-type">DerivationType</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679110696"><a href="#local-6989586621679110696"><span class="hs-identifier">depth</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Address.Derivation.html#Depth"><span class="hs-identifier hs-type">Depth</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="Index"><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier">Index</span></a></a><span>
</span><a name="line-328"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="indexToWord32"><a href="Cardano.Address.Derivation.html#indexToWord32"><span class="hs-identifier">indexToWord32</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Word32</span><span>
</span><a name="line-329"></a><span>    </span><span class="hs-comment">-- ^ Get the index as a 'Word32'</span><span>
</span><a name="line-330"></a><span>    </span><span class="hs-comment">-- @since 3.3.0</span><span>
</span><a name="line-331"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-332"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">stock</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-333"></a><span>
</span><a name="line-334"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><span class="hs-special">(</span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-type">Index</span></a><span> </span><a href="#local-6989586621679110705"><span class="hs-identifier hs-type">derivationType</span></a><span> </span><a href="#local-6989586621679110706"><span class="hs-identifier hs-type">depth</span></a><span class="hs-special">)</span><span>
</span><a name="line-335"></a><span>
</span><a name="line-336"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Bounded</span><span> </span><span class="hs-special">(</span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-type">Index</span></a><span> </span><span class="hs-special">'</span><a href="Cardano.Address.Derivation.html#Hardened"><span class="hs-identifier hs-type">Hardened</span></a><span> </span><a href="#local-6989586621679110704"><span class="hs-identifier hs-type">depth</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-337"></a><span>    </span><a name="local-8214565720323790309"><span class="hs-identifier">minBound</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-var">Index</span></a><span> </span><span class="hs-number">0x80000000</span><span>
</span><a name="line-338"></a><span>    </span><a name="local-8214565720323790308"><span class="hs-identifier">maxBound</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-var">Index</span></a><span> </span><span class="hs-identifier hs-var">maxBound</span><span>
</span><a name="line-339"></a><span>
</span><a name="line-340"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Bounded</span><span> </span><span class="hs-special">(</span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-type">Index</span></a><span> </span><span class="hs-special">'</span><a href="Cardano.Address.Derivation.html#Soft"><span class="hs-identifier hs-type">Soft</span></a><span> </span><a href="#local-6989586621679110701"><span class="hs-identifier hs-type">depth</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-341"></a><span>    </span><a name="local-8214565720323790309"><span class="hs-identifier">minBound</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-var">Index</span></a><span> </span><span class="hs-identifier hs-var">minBound</span><span>
</span><a name="line-342"></a><span>    </span><a name="local-8214565720323790308"><span class="hs-identifier">maxBound</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-var">Index</span></a><span> </span><a name="local-6989586621679110702"><a href="#local-6989586621679110702"><span class="hs-identifier">ix</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">minBound</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-type">Index</span></a><span> </span><span class="hs-special">'</span><a href="Cardano.Address.Derivation.html#Hardened"><span class="hs-identifier hs-type">Hardened</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span> </span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-var">Index</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110702"><span class="hs-identifier hs-var">ix</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-343"></a><span>
</span><a name="line-344"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Bounded</span><span> </span><span class="hs-special">(</span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-type">Index</span></a><span> </span><span class="hs-special">'</span><a href="Cardano.Address.Derivation.html#WholeDomain"><span class="hs-identifier hs-type">WholeDomain</span></a><span> </span><a href="#local-6989586621679110700"><span class="hs-identifier hs-type">depth</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-345"></a><span>    </span><a name="local-8214565720323790309"><span class="hs-identifier">minBound</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-var">Index</span></a><span> </span><span class="hs-identifier hs-var">minBound</span><span>
</span><a name="line-346"></a><span>    </span><a name="local-8214565720323790308"><span class="hs-identifier">maxBound</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-var">Index</span></a><span> </span><span class="hs-identifier hs-var">maxBound</span><span>
</span><a name="line-347"></a><span>
</span><a name="line-348"></a><span class="hs-comment">-- Construct an 'Index' from any Word32 value, without any validation, for</span><span>
</span><a name="line-349"></a><span class="hs-comment">-- internal use only.</span><span>
</span><a name="line-350"></a><span class="hs-comment">--</span><span>
</span><a name="line-351"></a><span class="hs-comment">-- Always use 'indexFromWord32' or 'wholeDomainIndex' instead of this function.</span><span>
</span><a name="line-352"></a><span class="hs-identifier">unsafeMkIndex</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Word32</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-type">Index</span></a><span> </span><a href="#local-6989586621679110717"><span class="hs-identifier hs-type">ty</span></a><span> </span><a href="#local-6989586621679110718"><span class="hs-identifier hs-type">depth</span></a><span>
</span><a name="line-353"></a><a name="unsafeMkIndex"><a href="Cardano.Address.Derivation.html#unsafeMkIndex"><span class="hs-identifier">unsafeMkIndex</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-var">Index</span></a><span>
</span><a name="line-354"></a><span>
</span><a name="line-355"></a><span class="hs-comment">-- | Construct derivation path indices from raw 'Word32' values.</span><span>
</span><a name="line-356"></a><span class="hs-identifier">indexFromWord32</span><span>
</span><a name="line-357"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679110714"><a href="#local-6989586621679110714"><span class="hs-identifier">ix</span></a></a><span> </span><a name="local-6989586621679110715"><a href="#local-6989586621679110715"><span class="hs-identifier">derivationType</span></a></a><span> </span><a name="local-6989586621679110716"><a href="#local-6989586621679110716"><span class="hs-identifier">depth</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-358"></a><span>       </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ix</span><span> </span><span class="hs-glyph">~</span><span> </span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-type">Index</span></a><span> </span><a href="#local-6989586621679110715"><span class="hs-identifier hs-type">derivationType</span></a><span> </span><a href="#local-6989586621679110716"><span class="hs-identifier hs-type">depth</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bounded</span><span> </span><a href="#local-6989586621679110714"><span class="hs-identifier hs-type">ix</span></a><span class="hs-special">)</span><span>
</span><a name="line-359"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Word32</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679110714"><span class="hs-identifier hs-type">ix</span></a><span>
</span><a name="line-360"></a><a name="indexFromWord32"><a href="Cardano.Address.Derivation.html#indexFromWord32"><span class="hs-identifier">indexFromWord32</span></a></a><span> </span><a name="local-6989586621679110751"><a href="#local-6989586621679110751"><span class="hs-identifier">ix</span></a></a><span>
</span><a name="line-361"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679110751"><span class="hs-identifier hs-var">ix</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><span class="hs-identifier">indexToWord32</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">minBound</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679110714"><span class="hs-identifier hs-type">ix</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679110751"><span class="hs-identifier hs-var">ix</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-identifier">indexToWord32</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">maxBound</span><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679110714"><span class="hs-identifier hs-type">ix</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-362"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-var">Index</span></a><span> </span><a href="#local-6989586621679110751"><span class="hs-identifier hs-var">ix</span></a><span class="hs-special">)</span><span>
</span><a name="line-363"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-364"></a><span>        </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-365"></a><span>
</span><a name="line-366"></a><span class="hs-comment">-- | Increment an index, if possible.</span><span>
</span><a name="line-367"></a><span class="hs-comment">--</span><span>
</span><a name="line-368"></a><span class="hs-comment">-- @since 3.3.0</span><span>
</span><a name="line-369"></a><span class="hs-identifier">nextIndex</span><span>
</span><a name="line-370"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679110711"><a href="#local-6989586621679110711"><span class="hs-identifier">ix</span></a></a><span> </span><a name="local-6989586621679110712"><a href="#local-6989586621679110712"><span class="hs-identifier">derivationType</span></a></a><span> </span><a name="local-6989586621679110713"><a href="#local-6989586621679110713"><span class="hs-identifier">depth</span></a></a><span class="hs-operator">.</span><span>
</span><a name="line-371"></a><span>       </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ix</span><span> </span><span class="hs-glyph">~</span><span> </span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-type">Index</span></a><span> </span><a href="#local-6989586621679110712"><span class="hs-identifier hs-type">derivationType</span></a><span> </span><a href="#local-6989586621679110713"><span class="hs-identifier hs-type">depth</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Bounded</span><span> </span><a href="#local-6989586621679110711"><span class="hs-identifier hs-type">ix</span></a><span class="hs-special">)</span><span>
</span><a name="line-372"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679110711"><span class="hs-identifier hs-type">ix</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679110711"><span class="hs-identifier hs-type">ix</span></a><span>
</span><a name="line-373"></a><a name="nextIndex"><a href="Cardano.Address.Derivation.html#nextIndex"><span class="hs-identifier">nextIndex</span></a></a><span> </span><span class="hs-special">(</span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-var">Index</span></a><span> </span><a name="local-6989586621679110752"><a href="#local-6989586621679110752"><span class="hs-identifier">ix</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Cardano.Address.Derivation.html#indexFromWord32"><span class="hs-identifier hs-var">indexFromWord32</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679110752"><span class="hs-identifier hs-var">ix</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-374"></a><span>
</span><a name="line-375"></a><span class="hs-comment">-- | Constructs a full domain 'Index'. This can't fail, unlike 'fromWord32'.</span><span>
</span><a name="line-376"></a><span class="hs-comment">--</span><span>
</span><a name="line-377"></a><span class="hs-comment">-- @since 3.3.0</span><span>
</span><a name="line-378"></a><span class="hs-identifier">wholeDomainIndex</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Word32</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-type">Index</span></a><span> </span><span class="hs-special">'</span><a href="Cardano.Address.Derivation.html#WholeDomain"><span class="hs-identifier hs-type">WholeDomain</span></a><span> </span><a href="#local-6989586621679110710"><span class="hs-identifier hs-type">depth</span></a><span>
</span><a name="line-379"></a><a name="wholeDomainIndex"><a href="Cardano.Address.Derivation.html#wholeDomainIndex"><span class="hs-identifier">wholeDomainIndex</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-var">Index</span></a><span>
</span><a name="line-380"></a><span>
</span><a name="line-381"></a><span class="hs-comment">-- | Upcasts an 'Index' to one with the full 'Word32' domain.</span><span>
</span><a name="line-382"></a><span class="hs-comment">--</span><span>
</span><a name="line-383"></a><span class="hs-comment">-- @since 3.3.0</span><span>
</span><a name="line-384"></a><span class="hs-identifier">coerceWholeDomainIndex</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-type">Index</span></a><span> </span><a href="#local-6989586621679110707"><span class="hs-identifier hs-type">ty</span></a><span> </span><a href="#local-6989586621679110708"><span class="hs-identifier hs-type">depth0</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-type">Index</span></a><span> </span><span class="hs-special">'</span><a href="Cardano.Address.Derivation.html#WholeDomain"><span class="hs-identifier hs-type">WholeDomain</span></a><span> </span><a href="#local-6989586621679110709"><span class="hs-identifier hs-type">depth1</span></a><span>
</span><a name="line-385"></a><a name="coerceWholeDomainIndex"><a href="Cardano.Address.Derivation.html#coerceWholeDomainIndex"><span class="hs-identifier">coerceWholeDomainIndex</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">coerce</span><span>
</span><a name="line-386"></a><span>
</span><a name="line-387"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Buildable</span><span> </span><span class="hs-special">(</span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-type">Index</span></a><span> </span><a href="#local-6989586621679110697"><span class="hs-identifier hs-type">derivationType</span></a><span> </span><a href="#local-6989586621679110698"><span class="hs-identifier hs-type">depth</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-388"></a><span>    </span><a name="local-8214565720323883922"><span class="hs-identifier">build</span></a><span> </span><span class="hs-special">(</span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-var">Index</span></a><span> </span><a name="local-6989586621679110699"><a href="#local-6989586621679110699"><span class="hs-identifier">ix</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromString</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679110699"><span class="hs-identifier hs-var">ix</span></a><span class="hs-special">)</span><span>
</span><a name="line-389"></a><span>
</span><a name="line-390"></a><span>
</span><a name="line-391"></a><span class="hs-comment">-- | Type of derivation that should be used with the given indexes.</span><span>
</span><a name="line-392"></a><span class="hs-comment">--</span><span>
</span><a name="line-393"></a><span class="hs-comment">-- In theory, we should only consider two derivation types: soft and hard.</span><span>
</span><a name="line-394"></a><span class="hs-comment">--</span><span>
</span><a name="line-395"></a><span class="hs-comment">-- However, historically, addresses in Cardano used to be generated across both</span><span>
</span><a name="line-396"></a><span class="hs-comment">-- the soft and the hard domain. We therefore introduce a 'WholeDomain' derivation</span><span>
</span><a name="line-397"></a><span class="hs-comment">-- type that is the exact union of `Hardened` and `Soft`.</span><span>
</span><a name="line-398"></a><span class="hs-comment">--</span><span>
</span><a name="line-399"></a><span class="hs-comment">-- @since 1.0.0</span><span>
</span><a name="line-400"></a><span class="hs-keyword">data</span><span> </span><a name="DerivationType"><a href="Cardano.Address.Derivation.html#DerivationType"><span class="hs-identifier">DerivationType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Hardened"><a href="Cardano.Address.Derivation.html#Hardened"><span class="hs-identifier">Hardened</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Soft"><a href="Cardano.Address.Derivation.html#Soft"><span class="hs-identifier">Soft</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="WholeDomain"><a href="Cardano.Address.Derivation.html#WholeDomain"><span class="hs-identifier">WholeDomain</span></a></a><span>
</span><a name="line-401"></a><span>
</span><a name="line-402"></a><span class="hs-comment">-- | An interface for doing hard derivations from the root private key, /Master Key/</span><span>
</span><a name="line-403"></a><span class="hs-comment">--</span><span>
</span><a name="line-404"></a><span class="hs-comment">-- @since 1.0.0</span><span>
</span><a name="line-405"></a><span class="hs-keyword">class</span><span> </span><a name="HardDerivation"><a href="Cardano.Address.Derivation.html#HardDerivation"><span class="hs-identifier">HardDerivation</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679110694"><a href="#local-6989586621679110694"><span class="hs-identifier">key</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Address.Derivation.html#Depth"><span class="hs-identifier hs-type">Depth</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-operator">*</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-406"></a><span>    </span><span class="hs-keyword">type</span><span> </span><a name="AccountIndexDerivationType"><a href="Cardano.Address.Derivation.html#AccountIndexDerivationType"><span class="hs-identifier">AccountIndexDerivationType</span></a></a><span> </span><a name="local-6989586621679110694"><a href="#local-6989586621679110694"><span class="hs-identifier">key</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Address.Derivation.html#DerivationType"><span class="hs-identifier hs-type">DerivationType</span></a><span>
</span><a name="line-407"></a><span>    </span><span class="hs-keyword">type</span><span> </span><a name="AddressIndexDerivationType"><a href="Cardano.Address.Derivation.html#AddressIndexDerivationType"><span class="hs-identifier">AddressIndexDerivationType</span></a></a><span> </span><a name="local-6989586621679110694"><a href="#local-6989586621679110694"><span class="hs-identifier">key</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Address.Derivation.html#DerivationType"><span class="hs-identifier hs-type">DerivationType</span></a><span>
</span><a name="line-408"></a><span>    </span><span class="hs-keyword">type</span><span> </span><a name="WithRole"><a href="Cardano.Address.Derivation.html#WithRole"><span class="hs-identifier">WithRole</span></a></a><span> </span><a name="local-6989586621679110694"><a href="#local-6989586621679110694"><span class="hs-identifier">key</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-operator">*</span><span>
</span><a name="line-409"></a><span>
</span><a name="line-410"></a><span>    </span><span class="hs-comment">-- | Derives account private key from the given root private key, using</span><span>
</span><a name="line-411"></a><span>    </span><span class="hs-comment">-- derivation scheme 2 (see &lt;https://github.com/input-output-hk/cardano-crypto/ cardano-crypto&gt;</span><span>
</span><a name="line-412"></a><span>    </span><span class="hs-comment">-- package for more details).</span><span>
</span><a name="line-413"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-414"></a><span>    </span><span class="hs-comment">-- @since 1.0.0</span><span>
</span><a name="line-415"></a><span>    </span><a name="deriveAccountPrivateKey"><a href="Cardano.Address.Derivation.html#deriveAccountPrivateKey"><span class="hs-identifier">deriveAccountPrivateKey</span></a></a><span>
</span><a name="line-416"></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679110694"><span class="hs-identifier hs-type">key</span></a><span> </span><span class="hs-special">'</span><a href="Cardano.Address.Derivation.html#RootK"><span class="hs-identifier hs-type">RootK</span></a><span> </span><a href="Cardano.Address.Derivation.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a><span>
</span><a name="line-417"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-type">Index</span></a><span> </span><span class="hs-special">(</span><a href="Cardano.Address.Derivation.html#AccountIndexDerivationType"><span class="hs-identifier hs-type">AccountIndexDerivationType</span></a><span> </span><a href="#local-6989586621679110694"><span class="hs-identifier hs-type">key</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><a href="Cardano.Address.Derivation.html#AccountK"><span class="hs-identifier hs-type">AccountK</span></a><span>
</span><a name="line-418"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110694"><span class="hs-identifier hs-type">key</span></a><span> </span><span class="hs-special">'</span><a href="Cardano.Address.Derivation.html#AccountK"><span class="hs-identifier hs-type">AccountK</span></a><span> </span><a href="Cardano.Address.Derivation.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a><span>
</span><a name="line-419"></a><span>
</span><a name="line-420"></a><span>    </span><span class="hs-comment">-- | Derives address private key from the given account private key, using</span><span>
</span><a name="line-421"></a><span>    </span><span class="hs-comment">-- derivation scheme 2 (see &lt;https://github.com/input-output-hk/cardano-crypto/ cardano-crypto&gt;</span><span>
</span><a name="line-422"></a><span>    </span><span class="hs-comment">-- package for more details).</span><span>
</span><a name="line-423"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-424"></a><span>    </span><span class="hs-comment">-- @since 1.0.0</span><span>
</span><a name="line-425"></a><span>    </span><a name="deriveAddressPrivateKey"><a href="Cardano.Address.Derivation.html#deriveAddressPrivateKey"><span class="hs-identifier">deriveAddressPrivateKey</span></a></a><span>
</span><a name="line-426"></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679110694"><span class="hs-identifier hs-type">key</span></a><span> </span><span class="hs-special">'</span><a href="Cardano.Address.Derivation.html#AccountK"><span class="hs-identifier hs-type">AccountK</span></a><span> </span><a href="Cardano.Address.Derivation.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a><span>
</span><a name="line-427"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Address.Derivation.html#WithRole"><span class="hs-identifier hs-type">WithRole</span></a><span> </span><a href="#local-6989586621679110694"><span class="hs-identifier hs-type">key</span></a><span>
</span><a name="line-428"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-type">Index</span></a><span> </span><span class="hs-special">(</span><a href="Cardano.Address.Derivation.html#AddressIndexDerivationType"><span class="hs-identifier hs-type">AddressIndexDerivationType</span></a><span> </span><a href="#local-6989586621679110694"><span class="hs-identifier hs-type">key</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><a href="Cardano.Address.Derivation.html#PaymentK"><span class="hs-identifier hs-type">PaymentK</span></a><span>
</span><a name="line-429"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110694"><span class="hs-identifier hs-type">key</span></a><span> </span><span class="hs-special">'</span><a href="Cardano.Address.Derivation.html#PaymentK"><span class="hs-identifier hs-type">PaymentK</span></a><span> </span><a href="Cardano.Address.Derivation.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a><span>
</span><a name="line-430"></a><span>
</span><a name="line-431"></a><span class="hs-comment">-- | An interface for doing soft derivations from an account public key</span><span>
</span><a name="line-432"></a><span class="hs-keyword">class</span><span> </span><a href="Cardano.Address.Derivation.html#HardDerivation"><span class="hs-identifier hs-type">HardDerivation</span></a><span> </span><a href="#local-6989586621679110693"><span class="hs-identifier hs-type">key</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="SoftDerivation"><a href="Cardano.Address.Derivation.html#SoftDerivation"><span class="hs-identifier">SoftDerivation</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679110693"><a href="#local-6989586621679110693"><span class="hs-identifier">key</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Address.Derivation.html#Depth"><span class="hs-identifier hs-type">Depth</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-operator">*</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-433"></a><span>    </span><span class="hs-comment">-- | Derives address public key from the given account public key, using</span><span>
</span><a name="line-434"></a><span>    </span><span class="hs-comment">-- derivation scheme 2 (see &lt;https://github.com/input-output-hk/cardano-crypto/ cardano-crypto&gt;</span><span>
</span><a name="line-435"></a><span>    </span><span class="hs-comment">-- package for more details).</span><span>
</span><a name="line-436"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-437"></a><span>    </span><span class="hs-comment">-- This is the preferred way of deriving new sequential address public keys.</span><span>
</span><a name="line-438"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-439"></a><span>    </span><span class="hs-comment">-- @since 1.0.0</span><span>
</span><a name="line-440"></a><span>    </span><a name="deriveAddressPublicKey"><a href="Cardano.Address.Derivation.html#deriveAddressPublicKey"><span class="hs-identifier">deriveAddressPublicKey</span></a></a><span>
</span><a name="line-441"></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679110693"><span class="hs-identifier hs-type">key</span></a><span> </span><span class="hs-special">'</span><a href="Cardano.Address.Derivation.html#AccountK"><span class="hs-identifier hs-type">AccountK</span></a><span> </span><a href="Cardano.Address.Derivation.html#XPub"><span class="hs-identifier hs-type">XPub</span></a><span>
</span><a name="line-442"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Address.Derivation.html#WithRole"><span class="hs-identifier hs-type">WithRole</span></a><span> </span><a href="#local-6989586621679110693"><span class="hs-identifier hs-type">key</span></a><span>
</span><a name="line-443"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Address.Derivation.html#Index"><span class="hs-identifier hs-type">Index</span></a><span> </span><span class="hs-special">'</span><a href="Cardano.Address.Derivation.html#Soft"><span class="hs-identifier hs-type">Soft</span></a><span> </span><span class="hs-special">'</span><a href="Cardano.Address.Derivation.html#PaymentK"><span class="hs-identifier hs-type">PaymentK</span></a><span>
</span><a name="line-444"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110693"><span class="hs-identifier hs-type">key</span></a><span> </span><span class="hs-special">'</span><a href="Cardano.Address.Derivation.html#PaymentK"><span class="hs-identifier hs-type">PaymentK</span></a><span> </span><a href="Cardano.Address.Derivation.html#XPub"><span class="hs-identifier hs-type">XPub</span></a><span>
</span><a name="line-445"></a><span>
</span><a name="line-446"></a><span>
</span><a name="line-447"></a><span class="hs-comment">-- | Abstract interface for constructing a /Master Key/.</span><span>
</span><a name="line-448"></a><span class="hs-comment">--</span><span>
</span><a name="line-449"></a><span class="hs-comment">-- @since 1.0.0</span><span>
</span><a name="line-450"></a><span class="hs-keyword">class</span><span> </span><a name="GenMasterKey"><a href="Cardano.Address.Derivation.html#GenMasterKey"><span class="hs-identifier">GenMasterKey</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679110692"><a href="#local-6989586621679110692"><span class="hs-identifier">key</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Address.Derivation.html#Depth"><span class="hs-identifier hs-type">Depth</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-operator">*</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-operator">*</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-451"></a><span>    </span><span class="hs-keyword">type</span><span> </span><a name="SecondFactor"><a href="Cardano.Address.Derivation.html#SecondFactor"><span class="hs-identifier">SecondFactor</span></a></a><span> </span><a name="local-6989586621679110692"><a href="#local-6989586621679110692"><span class="hs-identifier">key</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-operator">*</span><span>
</span><a name="line-452"></a><span>
</span><a name="line-453"></a><span>    </span><span class="hs-comment">-- | Generate a root key from a corresponding mnemonic.</span><span>
</span><a name="line-454"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-455"></a><span>    </span><span class="hs-comment">-- @since 1.0.0</span><span>
</span><a name="line-456"></a><span>    </span><a name="genMasterKeyFromMnemonic"><a href="Cardano.Address.Derivation.html#genMasterKeyFromMnemonic"><span class="hs-identifier">genMasterKeyFromMnemonic</span></a></a><span>
</span><a name="line-457"></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Mnemonic.html#SomeMnemonic"><span class="hs-identifier hs-type">SomeMnemonic</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Cardano.Address.Derivation.html#SecondFactor"><span class="hs-identifier hs-type">SecondFactor</span></a><span> </span><a href="#local-6989586621679110692"><span class="hs-identifier hs-type">key</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110692"><span class="hs-identifier hs-type">key</span></a><span> </span><span class="hs-special">'</span><a href="Cardano.Address.Derivation.html#RootK"><span class="hs-identifier hs-type">RootK</span></a><span> </span><a href="Cardano.Address.Derivation.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a><span>
</span><a name="line-458"></a><span>
</span><a name="line-459"></a><span>    </span><span class="hs-comment">-- | Generate a root key from a corresponding root 'XPrv'</span><span>
</span><a name="line-460"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-461"></a><span>    </span><span class="hs-comment">-- @since 1.0.0</span><span>
</span><a name="line-462"></a><span>    </span><a name="genMasterKeyFromXPrv"><a href="Cardano.Address.Derivation.html#genMasterKeyFromXPrv"><span class="hs-identifier">genMasterKeyFromXPrv</span></a></a><span>
</span><a name="line-463"></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="Cardano.Address.Derivation.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679110692"><span class="hs-identifier hs-type">key</span></a><span> </span><span class="hs-special">'</span><a href="Cardano.Address.Derivation.html#RootK"><span class="hs-identifier hs-type">RootK</span></a><span> </span><a href="Cardano.Address.Derivation.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a><span>
</span><a name="line-464"></a></pre></body></html>